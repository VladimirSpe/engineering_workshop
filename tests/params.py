import numpy as np
import math


def equal_matrix(mat1, mat2):
    return np.allclose(mat1, mat2, atol=0.01)


def equal_sol(sol1, sol2):
    if len(sol1) != len(sol2):
        return False
    for i in range(len(sol1)):
        if sol1.count(sol2[i]) != 1:
            return False
    return True


arr1 = np.array([[0, 1, 2, 3, 4, 5],
                 [1, np.inf, 0, 1, 0, 2],
                 [2, 0, np.inf, 5, 1, 0],
                 [3, 3, 4, np.inf, 2, 1],
                 [4, 5, 0, 7, np.inf, 1],
                 [5, 13, 4, 5, 1, np.inf]])

res1 = (np.array([[0, 1, 2, 3, 4, 5],
                  [1, np.inf, 0, 0, 0, 2],
                  [2, 0, np.inf, 4, 1, 0],
                  [3, 2, 3, np.inf, 1, 0],
                  [4, 5, 0, 6, np.inf, 1],
                  [5, 12, 3, 3, 0, np.inf]]), 3)

arr2 = np.array([[0, 1, 2, 3, 4, 5],
                 [1, np.inf, 4, 5, 7, 1],
                 [2, 2, np.inf, 5, 8, 0],
                 [3, 5, 7, np.inf, 5, 4],
                 [4, 4, 16, 3, np.inf, 4],
                 [5, 3, 6, 13, 15, np.inf]])

res2 = (np.array([[0, 1, 2, 3, 4, 5],
                  [1, np.inf, 0, 4, 5, 0],
                  [2, 2, np.inf, 5, 7, 0],
                  [3, 1, 0, np.inf, 0, 0],
                  [4, 1, 10, 0, np.inf, 1],
                  [5, 0, 0, 10, 11, np.inf]]), 15)

arr3 = np.array([[0, 1, 2, 3, 4, 5, 6, 7],
                 [1, np.inf, 82, 76, 47, 38, 57, 57],
                 [2, 48, np.inf, 59, 41, 56, 35, 67],
                 [3, 21, 61, np.inf, 59, 56, 56, 59],
                 [4, 70, 21, 58, np.inf, 91, 54, 81],
                 [5, 67, 43, 74, 76, np.inf, 27, 65],
                 [6, 15, 49, 27, 28, 58, np.inf, 19],
                 [7, 71, 31, 58, 72, 91, 76, np.inf]])

res3 = (np.array([[0, 1, 2, 3, 4, 5, 6, 7],
                  [1, np.inf, 44, 26, 3, 0, 19, 15],
                  [2, 13, np.inf, 12, 0, 21, 0, 28],
                  [3, 0, 40, np.inf, 32, 35, 35, 34],
                  [4, 49, 0, 25, np.inf, 70, 33, 56],
                  [5, 40, 16, 35, 43, np.inf, 0, 34],
                  [6, 0, 34, 0, 7, 43, np.inf, 0],
                  [7, 40, 0, 15, 35, 60, 45, np.inf]]), 210)
arr4 = np.array([[0, 1, 2, 3, 4, 5, 6, 7],
                 [1, np.inf, 0, 148, 154, 172, 14, 197],
                 [2, 22, np.inf, 184, 151, 105, 166, 16],
                 [3, 147, 134, np.inf, 194, 105, 174, 167],
                 [4, 72, 17, 178, np.inf, 25, 192, 46],
                 [5, 110, 115, 130, 61, np.inf, 165, 197],
                 [6, 79, 92, 3, 145, 189, np.inf, 68],
                 [7, 97, 36, 20, 66, 92, 190, np.inf]])

res4 = (np.array([[0, 1, 2, 3, 4, 5, 6, 7],
                  [1, np.inf, 0, 148, 154, 172, 0, 197],
                  [2, 0, np.inf, 168, 135, 89, 136, 0],
                  [3, 36, 29, np.inf, 89, 0, 55, 62],
                  [4, 49, 0, 161, np.inf, 8, 161, 29],
                  [5, 43, 54, 69, 0, np.inf, 90, 136],
                  [6, 70, 89, 0, 142, 186, np.inf, 65],
                  [7, 71, 16, 0, 46, 72, 156, np.inf]]), 242)
arr5 = np.array([[0, 1, 2, 3, 4, 5],
                 [1, np.inf, 12, 10, 4, 0],
                 [2, 0, np.inf, 9, 2, 6],
                 [3, 6, 12, np.inf, 0, 5],
                 [4, 0, 6, 0, np.inf, 1],
                 [5, 0, 0, 0, 0, np.inf]])

res5 = (5, 2, 4, 1)
res6 = (2, 1, 1, 0)

arr7 = np.array([[0, 1, 3, 4, 5],
                 [1, np.inf, 0, 11, 0],
                 [2, 5, 7, 0, 3],
                 [4, 2, 5, np.inf, 0],
                 [5, 7, 1, 4, np.inf]])

res7 = (2, 4, 1, 2)

arr8 = np.array([[0, 1, 2, 3],
                 [2, 0, np.inf, 11],
                 [3, 5, 0, np.inf],
                 [5, 7, 3, 0]])
res8 = (2, 1, 0, 0)

arr9 = (np.array([[0, 1, 2, 3, 4, 5],
                  [1, np.inf, 6, 10, 4, 0],
                  [2, 0, np.inf, 9, 2, 6],
                  [3, 6, 6, np.inf, 0, 5],
                  [4, 0, 0, 0, np.inf, 1],
                  [5, 0, 0, 0, 0, np.inf]]), 0, (5, 2, 4, 1))
res9 = 0

arr10 = (np.array([[0, 1, 3, 4, 5],
                   [1, np.inf, 10, 4, 0],
                   [2, 0, 9, 2, np.inf],
                   [3, 6, np.inf, 0, 5],
                   [4, 0, 0, np.inf, 1]]), 0, (4, 3, 3, 1))
res10_w = 7
res10_wo = 9

arr11 = np.array([[0, 1, 2, 3, 4, 5, 6],
                  [1, np.inf, 10, 15, 11, 2, 55],
                  [2, 17, np.inf, 16, 18, 21, 13],
                  [3, 10, 50, np.inf, 39, 22, 3],
                  [4, 28, 29, 24, np.inf, 28, 25],
                  [5, 27, 9, 32, 9, np.inf, 2],
                  [6, 43, 48, 40, 43, 21, np.inf]])
res11_1 = (np.array([[0, 1, 2, 3, 4, 5, 6],
                     [1, np.inf, 3, 13, 4, 0, 53],
                     [2, 0, np.inf, 3, 0, 8, 0],
                     [3, 3, 42, np.inf, 31, 19, 0],
                     [4, 0, 0, 0, np.inf, 4, 1],
                     [5, 21, 2, 30, 2, np.inf, 0],
                     [6, 18, 22, 19, 17, 0, np.inf]]), 79)
res11_2 = [(1, 4), (4, 3), (3, 6), (6, 5), (5, 2), (2, 1)]

arr12 = np.array([[0, 1, 2, 3, 4, 5, 6],
                  [1, np.inf, 41, 40, 48, 40, 42],
                  [2, 48, np.inf, 41, 49, 42, 46],
                  [3, 22, 22, np.inf, 23, 24, 19],
                  [4, 15, 17, 11, np.inf, 10, 14],
                  [5, 47, 43, 18, 42, np.inf, 52],
                  [6, 34, 39, 30, 39, 32, np.inf]])
res12 = [(5, 3), (3, 4), (1, 2), (6, 1), (2, 5), (4, 6)]

arr13 = np.array([[0, 1, 2, 3, 4, 5],
                  [1, np.inf, 4, 5, 7, 5],
                  [2, 8, np.inf, 5, 6, 6],
                  [3, 3, 5, np.inf, 9, 6],
                  [4, 3, 5, 6, np.inf, 2],
                  [5, 6, 2, 3, 8, np.inf]])
res13 = [(3, 1), (1, 2), (2, 4), (4, 5), (5, 3)]


file_kt_1 = "file_kt_1.json"
file_zd_1 = "file_zd_1.json"
# 2 Dangerous zone
res_file = [((0.5, 6), (2, 0)), ((4, 4), (1, 1))]

arr15 = [((0, 4), (4, 4)), ((0.5, 6), (2, 0))]

res15 = np.array([[np.inf, 4.03, np.inf, 5.02, 2.06],
                  [4.03, np.inf, 4.47, np.inf, np.inf],
                  [np.inf, 4.47, np.inf, 1.41, np.inf],
                  [5.02, np.inf, 1.41, np.inf, 3.16],
                  [2.06, np.inf, np.inf, 3.16, np.inf]])

arr16 = [(1004, 1003), (1007, 1002), (1005, 1006)]
res16 = [True, True, False]

arr17 = [[(27.100201, 100.100201), (30.100101, 40.100101)], [(14.100201, 80.100201), (100.100101, 13.100101)]]
res17 = [False, (True, (45.100101, 44.100101), 11)]

arr18 = [(35.100201, 80.100201), (52.100201, 14.100201), 11]
res18 = ((41.14470935797548, 13.111665274023988), (62.17000911134637, 18.527272786255885), 68.15423684555495)

arr19 = [(3, 2), 1, (2, 2), (4, 2)]
res19 = math.pi

arr20 = [11, (35.100201, 80.100201), (62.17000911134637, 18.527272786255885), (45.100101, 44.100101)]
res20 = ((54.36232187203905, 50.0340090307639), (55.828431207269176, 46.52969581473675), 71.92749449898035)

"""Тесты дополнения матрицы mTSP (upd_matr_bpla)"""
up_matr1 = np.array([[0, 1, 2, 3, 4],
                     [1, np.inf, 20, 30, 40],
                     [2, 20, np.inf, 30, 40],
                     [3, 30, 30, np.inf, 50],
                     [4, 40, 40, 50, np.inf]])

res_up_matr1 = np.array([[0, 1, 2, 3, 4, 41, 42, 43],
                         [1, np.inf, 20, 30, 40, 40, 40, 40],
                         [2, 20, np.inf, 30, 40, 40, 40, 40],
                         [3, 30, 30, np.inf, 50, 50, 50, 50],
                         [4, 40, 40, 50, np.inf, np.inf, np.inf, np.inf],
                         [41, 40, 40, 50, np.inf, np.inf, np.inf, np.inf],
                         [42, 40, 40, 50, np.inf, np.inf, np.inf, np.inf],
                         [43, 40, 40, 50, np.inf, np.inf, np.inf, np.inf]])

up_matr2 = np.array([[0, 1, 2, 3, 4, 5, 6, 7, 8],
                     [1, np.inf, 50.1401454, 97.2217792, 87.45322356, 81.3317765, 0.14184703, 104.28507779,
                      103.70376625],
                     [2, 50.1401454, np.inf, 53.40507296, 40.31140037, 43.08137417, 49.99972, 80.73511752,
                      60.07504807],
                     [3, 97.2217792, 53.40507296, np.inf, 20, 41, 97.08230014, 80.70938235, np.inf],
                     [4, 87.45322356, 40.31140037, 20, np.inf, np.inf, 87.32111429, 93.34881038, 21.54065923],
                     [5, 81.3317765, 43.08137417, 41, np.inf, np.inf, 81.21564628, 111.3263023, 23.85372088],
                     [6, 0.14184703, 49.99972, 97.08230014, 87.32111429, 81.21564628, np.inf, 104.18408844,
                      103.58076366],
                     [7, 104.28507779, 80.73511752, 80.70938235, 93.34881038, 111.3263023, 104.18408844, np.inf,
                      113.56937439],
                     [8, 103.70376625, 60.07504807, np.inf, 21.54065923, 23.85372088, 103.58076366, 113.56937439,
                      np.inf]])

res_up_matr2 = np.array([[0, 1, 2, 3, 4, 5, 6, 7, 8, 51, 52],
                         [1, np.inf, 50.1401454, 97.2217792, 87.45322356, 81.3317765, 0.14184703, 104.28507779,
                          103.70376625, 81.3317765, 81.3317765],
                         [2, 50.1401454, np.inf, 53.40507296, 40.31140037, 43.08137417, 49.99972, 80.73511752,
                          60.07504807, 43.08137417, 43.08137417],
                         [3, 97.2217792, 53.40507296, np.inf, 20, 41, 97.08230014, 80.70938235, np.inf, 41, 41],
                         [4, 87.45322356, 40.31140037, 20, np.inf, np.inf, 87.32111429, 93.34881038, 21.54065923,
                          np.inf, np.inf],
                         [5, 81.3317765, 43.08137417, 41, np.inf, np.inf, 81.21564628, 111.3263023, 23.85372088, np.inf,
                          np.inf],
                         [6, 0.14184703, 49.99972, 97.08230014, 87.32111429, 81.21564628, np.inf, 104.18408844,
                          103.58076366, 81.21564628, 81.21564628],
                         [7, 104.28507779, 80.73511752, 80.70938235, 93.34881038, 111.3263023, 104.18408844, np.inf,
                          113.56937439, 111.3263023, 111.3263023],
                         [8, 103.70376625, 60.07504807, np.inf, 21.54065923, 23.85372088, 103.58076366, 113.56937439,
                          np.inf, 23.85372088, 23.85372088],
                         [51, 81.3317765, 43.08137417, 41, np.inf, np.inf, 81.21564628, 111.3263023, 23.85372088,
                          np.inf,
                          np.inf],
                         [52, 81.3317765, 43.08137417, 41, np.inf, np.inf, 81.21564628, 111.3263023, 23.85372088,
                          np.inf, np.inf]])

"""Тесты на полноту Гамильтонова цикла (test_an)"""
tes_g_c1 = [(6, 1), (5, 8), (8, 4), (4, 3), (2, 6), (3, 5), (7, 2), (1, 7)]
test_g_c2 = [(1, 6), (5, 8), (8, 4), (4, 3), (7, 2), (2, 1), (6, 5), (3, 7)]